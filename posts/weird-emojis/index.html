<!doctype html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Bear plus snowflake equals polar bear - âŒ¨ï¸ğŸ¤·ğŸ»â€â™‚ï¸ğŸ“· </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="" />
    <meta property="og:site_name" content="âŒ¨ï¸ğŸ¤·ğŸ»â€â™‚ï¸ğŸ“·" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://andysalerno.com/posts/weird-emojis/" />
    <meta property="og:title" content="Bear plus snowflake equals polar bear" />
    <meta property="og:image" content="https://andysalerno.com/" />
    <meta property="og:description" content="" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:title" content="Bear plus snowflake equals polar bear" />
    <meta name="twitter:description" content="" />
    <meta name="twitter:image" content="https://andysalerno.com/" />

    <link rel="canonical" href="https://andysalerno.com/posts/weird-emojis/">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://andysalerno.com/css/custom.css" />

    

    

    <link rel="shortcut icon"
        href="https://andysalerno.com/images/favicon.png">

    
    <link href="https://andysalerno.com/index.xml" rel="alternate" type="application/rss+xml" title="âŒ¨ï¸ğŸ¤·ğŸ»â€â™‚ï¸ğŸ“·" />
    
</head>

<body>
    
<script data-goatcounter="https://andysalerno.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="/js/shuffle-message.js" defer></script>
<div class="mt-xl header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-auto">
                <a href="https://andysalerno.com/">
                    <h1 class="name">Andy, xor Andrew</h1>
                </a>
                <h8 class="tagline"><i>Professional software developer / hobbyist street photographer <span class="bonusTagline"></span>
                        <noscript> / Respects your js-disabled browsing</noscript> <span class="blinker"></span></i>
                </h8>
            </div>
        </div>

        <div class="row justify-content-center">
            <ul class="nav nav-primary">
                
                <li class="nav-item">
                    <a class="nav-link" href="/">
                        
                        Home
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/about/">
                        
                        About
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/andysalerno">
                        
                        GitHub
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/gallery/">
                        
                        Photo gallery
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://www.flickr.com/photos/andysalerno/">
                        
                        Flickr
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/index.xml">
                        
                        Rss (hey, why not)
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

<div id="myModal" class="myModal">
    <div class="flex-row">
        <i class=" myModal-content caption" id="modal-count">Click to view</i>
    </div>
    
    <div class="flex-row img-row">
        <div class="img-row-arrow-col">
            <div class="flex-pusher" onclick="goBackPrevImage()"></div>
            <div id="leftArrow" class="myModal-content caption img-row-arrow" onclick="goBackPrevImage()">&lt;</div>
            <div class="flex-pusher" onclick="goBackPrevImage()"></div>
        </div>
        <img class="myModal-content" id="modal-img" onclick="advanceNextImage()">
        <div class="img-row-arrow-col">
            <div class="caption close-button flex-pusher" onclick="closeModal()">X</div>
            <div class="flex-pusher-08" onclick="advanceNextImage()"></div>
            <div id="rightArrow" class="myModal-content caption img-row-arrow" onclick="advanceNextImage()">&gt;</div>
            <div class="flex-pusher" onclick="advanceNextImage()"></div>
        </div>
    </div>
    
</div>

<script src="/js/modal.js"></script>

<div class="content">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-8">
                <h1 class="mx-0 mx-md-4">Bear plus snowflake equals polar bear</h1>
                <div class="meta-date mx-0 mx-md-4">
                    <time>2021/06/13</time>
                </div>
                <div class="markdown">
                    
    <h4 id="prelude-e-and-e">Prelude: e and e</h4>
<p>Quick, how many bytes make up the following line? No tricks, I promise.</p>
<pre><code>Hello!
</code></pre><p>The correct answer is: 6.  Or 7, if you want to be pedantic and include the newline, but let&rsquo;s not.</p>
<p>This is simple enough; this page is encoded as UTF-8, which implies 8-bits per ASCII character, or a byte per character.</p>
<p>Let&rsquo;s play again.  How many bytes make up the following line?</p>
<pre><code>Hello!!
</code></pre><p>Easy enough.  7.  7 characters, so 7 bytes.</p>
<pre><code>$ echo -n 'Hello!!' | wc -c
$ 7
</code></pre><p>One more time.  What about the next line?</p>
<pre><code>HĞµllo!!!
</code></pre><p>Did you guess 8?  Or perhaps you realized I was trying to trick you.</p>
<p>Well, I <em>was</em> trying to trick you.</p>
<p>The correct answer is&hellip; 9! 9 bytes.</p>
<p>Don&rsquo;t believe me?  Go ahead and copy it from this page, and run a quick check:</p>
<pre><code>$ echo -n 'HĞµllo!!!' | wc -c
$ 9
</code></pre><p>Huh??  Where&rsquo;d that extra byte come from?  Well, the truth is, there&rsquo;s an <em>imposter</em> in that line.</p>
<p>That&rsquo;s right, it was the ol' UTF-8 Cryillic &lsquo;Ğµ&rsquo; trick.  No one ever expects <a href="https://util.unicode.org/UnicodeJsps/character.jsp?a=0435">U+0435</a>.  If it&rsquo;s your first time encountering this, a brief explanation: yes, UTF-8 is one-byte-per-character for the first 128 characters, correlating perfectly to traditional ASCII.  But the full Unicode standard, which UTF-8 encodes, includes <a href="https://unicode.org/versions/Unicode13.0.0/">143,859 characters</a> as of version 13.0.  To represent the full spectrum, UTF-8 must use multiple bytes for some characters (technically, <em>most</em> characters).  It just so happens that this vast range of characters includes some look-alikes, like your friendly neighborhood 1-byte ASCII &ldquo;e&rdquo; and your less-loved but still friendly 2-byte Cryillic &ldquo;Ğµ&rdquo;.</p>
<p>The Unicode website even shows you a handy little section called &ldquo;confuse&rdquo; that lists some of the</p>
<p>UTF-8 uses one to four bytes to encode each Unicode code point.</p>
<h4 id="enter-emojis">Enter: emojis</h4>
<p>Round two.  How many bytes in the following line?</p>
<pre><code>ğŸ™‚
</code></pre><p>The correct answer is&hellip; 4.  To represent Unicode <a href="https://util.unicode.org/UnicodeJsps/character.jsp?a=1F642&amp;B1=Show">U+1F642</a>, UTF-8 uses the full 4 bytes of a codepoint.</p>
<pre><code>$ echo -n 'ğŸ™‚' | wc -c
$ 4
</code></pre><p>Let&rsquo;s take a look at those bytes:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rs" data-lang="rs"><span style="color:#008000">// Rust
</span><span style="color:#008000"></span><span style="color:#00f">fn</span> main() {
    <span style="color:#00f">let</span> emoji = <span style="color:#a31515">&#34;ğŸ™‚&#34;</span>;

    println!(<span style="color:#a31515">&#34;Emoji: {}&#34;</span>, emoji);
    println!(<span style="color:#a31515">&#34;Length: {}&#34;</span>, emoji.len());
    println!(<span style="color:#a31515">&#34;Bytes: {:x?}&#34;</span>, emoji.as_bytes())
}
</code></pre></div><p>Output:</p>
<pre><code>Emoji: ğŸ™‚
Length: 4
Bytes: [f0, 9f, 99, 82]
</code></pre><p>How do those 4 bytes map to the Unicode character ğŸ™‚, code point <a href="https://unicode.org/emoji/charts/full-emoji-list.html#1f642">U+1F642</a>?</p>
<p>Let&rsquo;s look at those same bytes, represented in binary:</p>
<pre><code>11110000 10011111 10011001 10000010
</code></pre><p>In UTF-8, the first byte tells you how many bytes make up the character.  If the byte starts with <code>0</code>, it&rsquo;s a 1-byte character.  If it starts with a <code>1</code>, it is multiple bytes, and the next three bits tell you just how many bytes.  <a href="https://en.wikipedia.org/wiki/UTF-8#Encoding">The wikipedia article probably explains it better than I can,</a> but here&rsquo;s a simple table:</p>
<table>
<thead>
<tr>
<th><code>first byte prefix</code></th>
<th>|  <code>bytes in the unicode codepoint</code></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0xxxxxxx</code></td>
<td>| one byte</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>110xxxxx</code></td>
<td>| two bytes</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>1110xxxx</code></td>
<td>| three bytes</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>11110xxx</code></td>
<td>| four bytes</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>You may remember how earlier I said UTF-8 uses &ldquo;one byte per character for the first 128 characters&rdquo;, mapping directly to ASCII.  This is clever and convenient, because the 128 ASCII characters are represented by 7 bits (2^7 = 128), so UTF-8 can use the leftover first bit as a marker and still maintain perfect ASCII compatibility.</p>
<p><a href="https://stackoverflow.com/questions/14690159/is-ascii-code-7-bit-or-8-bit"><em>Relevant reading on StackOverflow: Is ASCII code 7-bit or 8-bit?</em></a></p>
<p>So, back to the binary representation of ğŸ™‚. The first byte is <code>11110000</code>, which begins with <code>11110</code>, meaning we must look at four bytes to know what codepoint this is.</p>
<p>The next three bytes each begin with <code>10</code>, which is the other unique prefix in UTF-8.  It simply means this byte is <em>not</em> the first in a codepoint.  I assume this is so parsers can determine mid-stream whether they are at the beginning of a character or not.</p>
<p>So let&rsquo;s trim off the prefixes from these four bytes:</p>
<pre><code>xxxxx000 xx011111 xx011001 xx000010
</code></pre><p>The result is:</p>
<pre><code>000 011111 011001 000010
000011111011001000010 // same, but removed spaces
</code></pre><p>If we take these 21 bits, and represent them as hex, we get:</p>
<pre><code>0x1F642
</code></pre><p>Which, what do you know, matches <a href="https://unicode.org/emoji/charts/full-emoji-list.html#1f642">U+1F642</a>, the Unicode codepoint for ğŸ™‚!</p>
<h4 id="emoji-math-">Emoji math ğŸ¤¯</h4>
<p>Let&rsquo;s play the game from the beginning <em>one</em> last time.</p>
<p>How many bytes are in the following line?</p>


<p>
  <img src="/images/hugemoji.png" style="width:40px">
</p>

<p>You might think the answer is 4.  You might also think I&rsquo;m trying to pull a fast one on you.</p>
<p>You&rsquo;d be wrong about the first, and right about the second.</p>
<p>The answer is&hellip;</p>
<p>&hellip;35.</p>
<p>No, not 35 <em>bits.</em></p>
<p><strong>35 bytes.</strong></p>
<p>I must admit something: I cheated.  The example I gave above was actually an image, since your browser may not have recent enough fonts to render this new Unicode 13.1 character. Here&rsquo;s your browser&rsquo;s attempt at rendering it natively:</p>


<pre class="emojiblock content markdown emojiblock" style='font-family:"Noto Color Emoji","Apple Color Emoji","Segoe UI Emoji",Times,Symbola,Aegyptus,Code2000,Code2001,Code2002,Musica,serif,LastResort;font-size:24px'>
ğŸ‘©ğŸ¾â€â¤ï¸â€ğŸ’‹â€ğŸ‘©ğŸ»
</pre>

<p>If your fonts are recent enough, you should see something like the image.</p>
<p>If your fonts are too old to represent <a href="https://emojipedia.org/emoji-13.1/">Unicode 13.1</a>, you may have seen something like this, which answers the riddle of how one UTF-8 character &ndash; which we know from earlier is a maximum of 4 bytes &ndash; can be 36 bytes:</p>
<pre><code>ğŸ‘©ğŸ¾â¤ğŸ’‹ğŸ‘©ğŸ»
</code></pre><p>That&rsquo;s right.  It&rsquo;s more than 4 bytes because <em>it&rsquo;s more than one character!</em>  The emoji you (hopefully) saw is actually defined <em>in terms of other emojis</em>, spliced together with an invisible codepoint!!</p>
<p>Let&rsquo;s break it down with Emoji Math(TM):</p>


<pre class="emojiblock content markdown emojiblock" style='font-family:"Noto Color Emoji","Apple Color Emoji","Segoe UI Emoji",Times,Symbola,Aegyptus,Code2000,Code2001,Code2002,Musica,serif,LastResort;font-size:24px'>
ğŸ‘©ğŸ¾ + â¤ + ğŸ’‹ + ğŸ‘©ğŸ» = <img src="/images/hugemoji.png" style="width:40px">
</pre>

<p>In fact, we can expand the above even further, since skin tones are spliced together in the same way:</p>


<pre class="emojiblock content markdown emojiblock" style='font-family:"Noto Color Emoji","Apple Color Emoji","Segoe UI Emoji",Times,Symbola,Aegyptus,Code2000,Code2001,Code2002,Musica,serif,LastResort;font-size:24px'>
ğŸ‘© + ğŸ¾ + â¤ + ğŸ’‹ + ğŸ‘© + ğŸ»

= ğŸ‘©ğŸ¾ + â¤ + ğŸ’‹ + ğŸ‘©ğŸ» 

= <img src="/images/hugemoji.png" style="width:40px">
</pre>

<p>All of this can be seen in the Unicode codepoint for the emoji, which Unicode has named: &ldquo;kiss: woman, woman, medium-dark skin tone, light skin tone&rdquo;.</p>
<p><a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html#1f469_1f3fe_200d_2764_fe0f_200d_1f48b_200d_1f469_1f3fb">Here&rsquo;s the raw codepoint definition:</a></p>
<pre><code>U+1F469 U+1F3FE U+200D U+2764 U+FE0F U+200D U+1F48B U+200D U+1F469 U+1F3FB
</code></pre><p>And here&rsquo;s the same, annotated:</p>
<pre><code>U+1F469: ğŸ‘© (4 bytes)
U+1F3FE: ğŸ¾ (4 bytes)
U+200D : zero-width join (3 bytes)
U+2764 : â¤ (3 bytes)
U+FE0F : variation selector (3 bytes)
U+200D : zero-width join (3 bytes)
U+1F48B: ğŸ’‹ (4 bytes)
U+200D : zero-width join (3 bytes)
U+1F469: ğŸ‘© (4 bytes)
U+1F3FB: ğŸ» (4 bytes)

Total: 35 bytes
</code></pre><p>Now we can see how one <em>character</em> can be made up of multiple <em>codepoints</em> which are in turn made up of multiple bytes.</p>
<p>Fun fact: while some of these emoji codepoint combinations are quite obvious, such as:</p>
<pre><code>ğŸ‘© + ğŸ¿ = ğŸ‘©ğŸ¿
</code></pre><p>Others are made up of pretty fun combinations.  Clearly the unicode committee had some fun with this.  Here are some interesting ones:</p>
<pre><code>  ğŸ‘© (woman; U+1F469)
+ ğŸŒ¾ (sheaf of rice; U+1F33E)
= ğŸ‘©â€ğŸŒ¾ (woman farmer; U+1F469 U+200D U+1F33E)

  ğŸ‘¨ (man; U+1F468)
+ ğŸ­ (factory; U+1F3ED)
= ğŸ‘¨â€ğŸ­ (man factory worker; U+1F468 U+200D U+1F3ED)

  ğŸ‘© (woman; U+1F469)
+ âœˆ (plane; U+2708)
= ğŸ‘©â€âœˆï¸ (woman pilot; U+1F469 U+200D U+2708 U+FE0F)

  ğŸ‘© (woman; U+1F469)
+ ğŸš€ (rocket; U+1F680)
= ğŸ‘©â€ğŸš€ (woman astronaut; U+1F469 U+200D U+1F680)
</code></pre>

<pre class="emojiblock content markdown emojiblock" style='font-family:"Noto Color Emoji","Apple Color Emoji","Segoe UI Emoji",Times,Symbola,Aegyptus,Code2000,Code2001,Code2002,Musica,serif,LastResort;font-size:18px'>
<span style='font-family:mono'>  </span>ğŸ‘©<span style='font-family:mono'> (woman; U+1F469)</span>
<span style='font-family:mono'>+ </span>ğŸŒ¾<span style='font-family:mono'> (sheaf of rice; U+1F33E)</span>
<span style='font-family:mono'>= </span>ğŸ‘©â€ğŸŒ¾ï¸<span style='font-family:mono'> (woman farmer; U+1F469 U+200D U+1F33E)</span>

<span style='font-family:mono'>  </span>ğŸ‘¨<span style='font-family:mono'> (man; U+1F468)</span>
<span style='font-family:mono'>+ </span>ğŸ­<span style='font-family:mono'> (factory; U+1F3ED)</span>
<span style='font-family:mono'>= </span>ğŸ‘¨â€ğŸ­ï¸<span style='font-family:mono'> (man factory worker; U+1F468 U+200D U+1F3ED)</span>

<span style='font-family:mono'>  </span>ğŸ‘©<span style='font-family:mono'> (woman; U+1F469)</span>
<span style='font-family:mono'>+ </span>âœˆ<span style='font-family:mono'> (plane; U+2708)</span>
<span style='font-family:mono'>= </span>ğŸ‘©â€âœˆï¸ï¸<span style='font-family:mono'> (woman pilot; U+1F469 U+200D U+2708 U+FE0F)</span>

<span style='font-family:mono'>  </span>ğŸ‘©<span style='font-family:mono'> (woman; U+1F469)</span>
<span style='font-family:mono'>+ </span>ğŸš€<span style='font-family:mono'> (rocket; U+1F680)</span>
<span style='font-family:mono'>= </span>ğŸ‘©â€ğŸš€ï¸<span style='font-family:mono'> (woman astronaut; U+1F469 U+200D U+1F680)</span>
</pre>

<p>And finally, perhaps my favorite, which I like so much I made it the title of this blog post.</p>


<pre class="emojiblock content markdown emojiblock" style='font-family:"Noto Color Emoji","Apple Color Emoji","Segoe UI Emoji",Times,Symbola,Aegyptus,Code2000,Code2001,Code2002,Musica,serif,LastResort;font-size:18px'>
<span style='font-family:mono'>  </span>ğŸ»<span style='font-family:mono'> (bear; U+1F43B)</span>
<span style='font-family:mono'>+ </span>â„<span style='font-family:mono'> (snowflake; U+2744)</span>
<span style='font-family:mono'>= </span>ğŸ»â€â„ï¸<span style='font-family:mono'> (polar bear; U+1F43B U+200D U+2744 U+FE0F)</span>
</pre>

<h4 id="addendum-characters-or-codepoints">Addendum: characters, or codepoints?</h4>



                </div>
            </div>
        </div>
    </div>
</div>




    

    

    

    
    
</body>

</html>
